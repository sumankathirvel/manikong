StackExchange=window.StackExchange||{},StackExchange.Unikong=StackExchange.Unikong||{},StackExchange.Unikong.Credits=function(){};var textGroup;StackExchange.Unikong.Credits.prototype={"create":function(){this.game.world.removeAll(),textGroup=this.game.add.group();var t=this.game.add.sprite(0,0,"credits");textGroup.add(t);var e=this.game.add.sprite(this.game.world.centerX,680,"btn-return");e.anchor.setTo(.5,1),e.frame=1,e.inputEnabled=!0,e.events.onInputDown.add(function(){this.menu()},this),textGroup.add(e);var a=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);a.onDown.addOnce(this.menu,this);var i=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);i.onDown.addOnce(this.menu,this)},"menu":function(){var t=this.game.add.tween(textGroup).to({"alpha":0},1500);t.onComplete.add(function(){this.game.state.start("Menu")},this),t.start()}},StackExchange.Unikong.Leaderboard=function(){};var textGroup;StackExchange.Unikong.Leaderboard.prototype={"create":function(){this.game.world.removeAll();var t=this.game.add.sprite(0,0,"scores-bg");textGroup=this.game.add.group(),textGroup.add(t),StackExchange.Unikong.generateLeaderboardScores(textGroup);var e=this.game.add.sprite(this.game.world.centerX,680,"btn-return");e.anchor.setTo(.5,1),e.frame=1,e.inputEnabled=!0,e.events.onInputDown.add(function(){this.menu()},this),textGroup.add(e);var a=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);a.onDown.addOnce(this.menu,this);var i=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);i.onDown.addOnce(this.menu,this)},"menu":function(){var t=this.game.add.tween(textGroup).to({"alpha":0},1500);t.onComplete.add(function(){this.game.state.start("Menu")},this),t.start()}},StackExchange.Unikong.Loss=function(){};var imgGroup,btnArray,btnArrayIndex,isActivated;StackExchange.Unikong.Loss.prototype={"create":function(){btnArray=[],btnArrayIndex=0,isActivated=!1,this.game.world.removeAll(),StackExchange.Unikong.stopMusic(),imgGroup=this.game.add.group();var t=this.game.add.sprite(0,0,"game-over-bg"),e=this.game.add.text(this.game.world.centerX,175,"your final rep was "+score,fontStyle);e.anchor.setTo(.5,1),restartBtn=this.game.add.sprite(225,285,"btn-restart"),restartBtn.frame=1,restartBtn.inputEnabled=!0,restartBtn.events.onInputDown.add(function(){this.toggleMenu(null,0),this.letsGo()},this),scoresBtn=this.game.add.sprite(225,355,"btn-leaderboard"),scoresBtn.frame=0,scoresBtn.inputEnabled=!0,scoresBtn.events.onInputDown.add(function(){this.toggleMenu(null,1),this.letsGo()},this),menuBtn=this.game.add.sprite(225,425,"btn-return"),menuBtn.frame=0,menuBtn.inputEnabled=!0,menuBtn.events.onInputDown.add(function(){this.toggleMenu(null,2),this.letsGo()},this),exitBtn=this.game.add.sprite(225,495,"btn-exit"),exitBtn.frame=0,exitBtn.inputEnabled=!0,exitBtn.events.onInputDown.add(function(){this.toggleMenu(null,3),this.letsGo()},this),imgGroup.add(t),imgGroup.add(e),imgGroup.add(restartBtn),imgGroup.add(scoresBtn),imgGroup.add(menuBtn),imgGroup.add(exitBtn),btnArray.push(restartBtn),btnArray.push(scoresBtn),btnArray.push(menuBtn),btnArray.push(exitBtn);var a=this.game.input.keyboard.addKey(Phaser.Keyboard.UP),i=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN);a.onDown.add(this.toggleMenu,this,0),i.onDown.add(this.toggleMenu,this,0);var s=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);s.onDown.addOnce(this.letsGo,this);var n=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);n.onDown.addOnce(this.letsGo,this),StackExchange.Unikong.generateLeaderboardScores(null,!0)},"toggleMenu":function(t,e){if(!isActivated){if(void 0!==e)return btnArray.forEach(function(t){t.frame=0}),btnArray[e].frame=1,btnArrayIndex=e,void 0;var a=t.keyCode===Phaser.KeyCode.UP;btnArray[btnArrayIndex].frame=0,btnArrayIndex=((a?--btnArrayIndex:++btnArrayIndex)%btnArray.length+btnArray.length)%btnArray.length,btnArray[btnArrayIndex].frame=1}},"letsGo":function(){isActivated=!0;var t=this.game.add.tween(imgGroup).to({"alpha":0},1500);t.onComplete.add(function(){1===btnArray[0].frame?this.game.state.start("Restart"):1===btnArray[1].frame?this.game.state.start("Leaderboard"):1===btnArray[2].frame?this.game.state.start("Menu"):StackExchange.Unikong.quit()},this),t.start()}},StackExchange.Unikong.Player=function(t,e,a,i,s){Phaser.Sprite.call(this,t,e,a,i),this.isClimbing=!1,this.isDead=!1,this.isArmed="player-armed"===i,this.hasKey=!1,this.lastHorizontalMoveLeft=!1,this.isFacingLeft=!1,this.lossSound=s,this.enableBody=!0,t.physics.enable(this,Phaser.Physics.ARCADE),this.body.bounce.y=.2,this.body.gravity.y=300,this.anchor.setTo(.5,.5),this.body.collideWorldBounds=!0,this.animations.add("left",[0,1,2,3],10,!0),this.animations.add("right",[5,6,7,8],10,!0),this.animations.add("climb",[9,10,11],10,!0),t.add.existing(this)},StackExchange.Unikong.Player.prototype=Object.create(Phaser.Sprite.prototype),StackExchange.Unikong.Player.prototype.constructor=StackExchange.Unikong.Player,StackExchange.Unikong.Player.prototype.wompwomp=function(){this.checkWorldBounds=!0,this.body.collideWorldBounds=!1,this.isDead=!0,this.isArmed=!1,this.angle=270,this.moves=!1,this.body.gravity.y=0,this.body.velocity.y=2*moveSpeed,this.events.onOutOfBounds.addOnce(function(){if(0===remainingLives){var t=this.game.add.text(this.game.world.centerX,-10,Math.random()<=.5?"oh no":"womp womp",fontStyle);t.anchor.setTo(.5,.5),this.lossSound.play();var e=this.game.add.tween(t).to({"y":this.game.world.centerY},3e3,"Quart.easeOut");e.onComplete.add(function(){this.game.state.start("Loss")},this),e.start()}else this.game.state.start("LevelTransition")},this)},StackExchange.Unikong.Player.prototype.arm=function(){this.loadTexture("player-armed",this.frame),this.isArmed=!0},StackExchange.Unikong.Boss=function(t,e,a,i){Phaser.Sprite.call(this,t,e,a,"boss",3),this.enableBody=!0,t.physics.enable(this,Phaser.Physics.ARCADE),this.defaultVelocity=50,this.targetingRate=35,this.velocity=this.defaultVelocity,this.isThrowingDownvote=!1,this.stopped=!1,this.player=i,this.body.velocity.x=this.velocity,this.body.collideWorldBounds=!0,this.animations.add("left",[0,1,2,3],10,!0),this.animations.add("right",[4,5,6,7],10,!0),this.frame=4,this.downvotes=this.game.add.group();for(var s=0;15>s;s++){var n=new StackExchange.Unikong.DownvoteTorch(t,this);this.downvotes.add(n),0==s&&(StackExchange.Unikong.DownvoteTorch.Width=n.width)}this.game.physics.enable(this.downvotes,Phaser.Physics.ARCADE),this.particleEmitter=this.game.add.emitter(0,0,100),this.particleEmitter.makeParticles("goldParticle"),this.particleEmitter.x=this.x+this.body.width,this.particleEmitter.y=this.y,this.particleEmitter.gravity=0,this.particleEmitter.start(!1,150,150),t.add.existing(this),this.animations.play("right"),t.time.events.loop(4*Phaser.Timer.SECOND*weaponDropRateFactor,this.throwDownvote,this)},StackExchange.Unikong.Boss.prototype=Object.create(Phaser.Sprite.prototype),StackExchange.Unikong.Boss.prototype.constructor=StackExchange.Unikong.Boss,StackExchange.Unikong.Boss.prototype.move=function(){if(this.player.isDead||this.isThrowingDownvote||this.stopped)return this.body.velocity.x=0,void 0;this.body.velocity.x=this.isMovingLeft?-this.defaultVelocity:this.defaultVelocity,this.particleEmitter.x=this.isMovingLeft?this.x:this.x+this.body.width;var t=StackExchange.Unikong.DownvoteTorch.Width;this.x+this.width+t>=this.game.world.width-5?(this.body.velocity.x=-this.velocity,this.frame=3,this.animations.play("left"),this.isMovingLeft=!0):this.x-t<=5&&(this.body.velocity.x=this.velocity,this.frame=4,this.animations.play("right"),this.isMovingLeft=!1)},StackExchange.Unikong.Boss.prototype.possiblyAlterMovement=function(){if(this.player.isDead||this.isThrowingDownvote||this.stopped)return this.body.velocity.x=0,void 0;var t=this.player.body.x+this.player.body.width/2<=this.body.x+this.body.width/2,e=100*Math.random()+0<unicornTargetingRate;this.isMovingLeft&&!t&&e?(this.body.velocity.x=this.defaultVelocity,this.frame=4,this.animations.play("right"),this.isMovingLeft=!1):!this.isMovingLeft&&t&&e?(this.body.velocity.x=-this.defaultVelocity,this.frame=3,this.animations.play("left"),this.isMovingLeft=!0):this.body.velocity.x=this.isMovingLeft?-this.defaultVelocity:this.defaultVelocity},StackExchange.Unikong.Boss.prototype.throwDownvote=function(){if(!this.player.isDead&&!this.stopped){var t=this.downvotes.getFirstExists(!1);t&&t.doThrow()}},StackExchange.Unikong.Boss.prototype.stopDownvotes=function(){this.downvotes.forEachAlive(function(t){t.body.allowGravity=!1,t.body.gravity=0,t.body.velocity.y=0})},StackExchange.Unikong.Troll=function(t,e,a,i,s,n){Phaser.Sprite.call(this,t,e,a,"troll"),this.enableBody=!0,t.physics.enable(this,Phaser.Physics.ARCADE),this.defaultVelocity=trollSpeed,this.velocity=this.defaultVelocity,this.player=i,this.minX=s||5,this.maxX=n||t.world.width-5,this.body.velocity.x=this.velocity,this.body.collideWorldBounds=!0,this.animations.add("left",[0,1,2,3],10,!0),this.animations.add("right",[4,5,6,7],10,!0),this.frame=4,t.add.existing(this),this.animations.play("right")},StackExchange.Unikong.Troll.prototype=Object.create(Phaser.Sprite.prototype),StackExchange.Unikong.Troll.prototype.constructor=StackExchange.Unikong.Troll,StackExchange.Unikong.Troll.prototype.move=function(){return this.player.isDead?(this.body.velocity.x=0,void 0):(this.body.velocity.x=this.isMovingLeft?-this.defaultVelocity:this.defaultVelocity,this.x+this.width>=this.maxX?(this.body.velocity.x=-this.velocity,this.frame=3,this.animations.play("left"),this.isMovingLeft=!0):this.x<=this.minX&&(this.body.velocity.x=this.velocity,this.frame=4,this.animations.play("right"),this.isMovingLeft=!1),void 0)},StackExchange.Unikong.Troll.prototype.wompwomp=function(){this.checkWorldBounds=!0,this.body.collideWorldBounds=!1,this.isDead=!0,this.angle=270,this.moves=!1,this.body.gravity.y=0,this.body.velocity.y=2*moveSpeed},StackExchange.Unikong.Menu=function(){},StackExchange.Unikong.Menu.prototype={"create":function(){btnArray=[],btnArrayIndex=0,isActivated=!1,imgGroup=this.game.add.group();var t=this.game.add.sprite(0,0,"menu-bg"),e=this.game.add.emitter(0,0,100);e.makeParticles("goldParticle"),e.x=this.game.world.width/2+179,e.y=this.game.world.height/2-157,e.gravity=0,e.start(!1,500,3),newBtn=this.game.add.sprite(65,215,"btn-new"),newBtn.frame=1,newBtn.inputEnabled=!0,newBtn.events.onInputDown.add(function(){this.toggleMenu(null,0),this.letsGo()},this),scoresBtn=this.game.add.sprite(65,285,"btn-leaderboard"),scoresBtn.frame=0,scoresBtn.inputEnabled=!0,scoresBtn.events.onInputDown.add(function(){this.toggleMenu(null,1),this.letsGo()},this),creditsBtn=this.game.add.sprite(65,355,"btn-credits"),creditsBtn.frame=0,creditsBtn.inputEnabled=!0,creditsBtn.events.onInputDown.add(function(){this.toggleMenu(null,2),this.letsGo()},this),exitBtn=this.game.add.sprite(65,425,"btn-exit"),exitBtn.frame=0,exitBtn.inputEnabled=!0,exitBtn.events.onInputDown.add(function(){this.toggleMenu(null,3),this.letsGo()},this),imgGroup.add(t),imgGroup.add(newBtn),imgGroup.add(scoresBtn),imgGroup.add(creditsBtn),imgGroup.add(exitBtn),imgGroup.add(e),btnArray.push(newBtn),btnArray.push(scoresBtn),btnArray.push(creditsBtn),btnArray.push(exitBtn);var a=this.game.input.keyboard.addKey(Phaser.Keyboard.UP),i=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN);a.onDown.add(this.toggleMenu,this,0),i.onDown.add(this.toggleMenu,this,0);var s=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);s.onDown.addOnce(this.letsGo,this);var n=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);n.onDown.addOnce(this.letsGo,this),StackExchange.Unikong.startMusic(),StackExchange.Unikong.bindSoundToggle()},"toggleMenu":function(t,e){if(!isActivated){if(void 0!==e)return btnArray.forEach(function(t){t.frame=0}),btnArray[e].frame=1,btnArrayIndex=e,void 0;var a=t.keyCode===Phaser.KeyCode.UP;btnArray[btnArrayIndex].frame=0,btnArrayIndex=((a?--btnArrayIndex:++btnArrayIndex)%btnArray.length+btnArray.length)%btnArray.length,btnArray[btnArrayIndex].frame=1}},"letsGo":function(){isActivated=!0;var t=this.game.add.tween(imgGroup).to({"alpha":0},1500);t.onComplete.add(function(){1===btnArray[0].frame?this.game.state.start("Restart"):1===btnArray[1].frame?this.game.state.start("Leaderboard"):1===btnArray[2].frame?this.game.state.start("Credits"):StackExchange.Unikong.quit()},this),t.start()}},StackExchange.Unikong.Win=function(){},StackExchange.Unikong.Win.prototype={"create":function(){btnArray=[],btnArrayIndex=0,isActivated=!1,this.game.world.removeAll(),StackExchange.Unikong.stopMusic(),imgGroup=this.game.add.group();var t=this.game.add.sprite(0,0,"win-bg"),e=this.game.add.text(this.game.world.centerX,175,"your current rep is "+score,fontStyle);e.anchor.setTo(.5,1),continueBtn=this.game.add.sprite(215,285,"btn-continue"),continueBtn.frame=1,continueBtn.inputEnabled=!0,continueBtn.events.onInputDown.add(function(){this.toggleMenu(null,0),this.letsGo()},this),restartBtn=this.game.add.sprite(215,355,"btn-restart"),restartBtn.frame=0,restartBtn.inputEnabled=!0,restartBtn.events.onInputDown.add(function(){this.toggleMenu(null,1),this.letsGo()},this),menuBtn=this.game.add.sprite(215,425,"btn-return"),menuBtn.frame=0,menuBtn.inputEnabled=!0,menuBtn.events.onInputDown.add(function(){this.toggleMenu(null,3),this.letsGo()},this),exitBtn=this.game.add.sprite(215,495,"btn-exit"),exitBtn.frame=0,exitBtn.inputEnabled=!0,exitBtn.events.onInputDown.add(function(){this.toggleMenu(null,4),this.letsGo()},this),imgGroup.add(t),imgGroup.add(e),imgGroup.add(continueBtn),imgGroup.add(restartBtn),imgGroup.add(menuBtn),imgGroup.add(exitBtn),btnArray.push(continueBtn),btnArray.push(restartBtn),btnArray.push(menuBtn),btnArray.push(exitBtn);var a=this.game.input.keyboard.addKey(Phaser.Keyboard.UP),i=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN);a.onDown.add(this.toggleMenu,this,0),i.onDown.add(this.toggleMenu,this,0);var s=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);s.onDown.addOnce(this.letsGo,this);var n=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);n.onDown.addOnce(this.letsGo,this),StackExchange.Unikong.generateLeaderboardScores(null,!0)},"toggleMenu":function(t,e){if(!isActivated){if(void 0!==e)return btnArray.forEach(function(t){t.frame=0}),btnArray[e].frame=1,btnArrayIndex=e,void 0;var a=t.keyCode===Phaser.KeyCode.UP;btnArray[btnArrayIndex].frame=0,btnArrayIndex=((a?--btnArrayIndex:++btnArrayIndex)%btnArray.length+btnArray.length)%btnArray.length,btnArray[btnArrayIndex].frame=1}},"letsGo":function(){isActivated=!0;var t=this.game.add.tween(imgGroup).to({"alpha":0},1500);t.onComplete.add(function(){1===btnArray[0].frame?(StackExchange.Unikong.level<=12&&(gameSpeedFactor+=.5,weaponDropRateFactor*=.75,trollSpeed+=10,unicornTargetingRate+=10),StackExchange.Unikong.level+=1,this.game.state.start("LevelTransition")):1===btnArray[1].frame?this.game.state.start("Restart"):1===btnArray[2].frame?this.game.state.start("Menu"):StackExchange.Unikong.quit()},this),t.start()}},StackExchange.Unikong.DownvoteTorch=function(t,e){Phaser.Sprite.call(this,t,0,0,"downvote"),this.boss=e,this.enableBody=!0,t.physics.enable(this,Phaser.Physics.ARCADE),this.exists=!1,this.body.gravity.y=50*gameSpeedFactor,this.checkWorldBounds=!0,this.outOfBoundsKill=!0;var a=this.animations.add("init",[0,1,2,3,4,5],10,!1);a.onComplete.add(function(){e.isThrowingDownvote=!1,e.possiblyAlterMovement()}),this.animations.add("burn",[6,7,8],10,!0),a.onComplete.add(function(){this.animations.play("burn")},this),t.add.existing(this)},StackExchange.Unikong.DownvoteTorch.prototype=Object.create(Phaser.Sprite.prototype),StackExchange.Unikong.DownvoteTorch.prototype.constructor=StackExchange.Unikong.DownvoteTorch,StackExchange.Unikong.DownvoteTorch.prototype.doThrow=function(){var t=this.boss.x+this.boss.width/2;this.reset(t+(this.boss.isMovingLeft?-1*this.boss.width:this.boss.width-this.width),this.boss.y),this.boss.isThrowingDownvote=!0,this.animations.play("init")},StackExchange.Unikong.TreasureItem=function(t,e,a,i,s,n,r,o){Phaser.Sprite.call(this,t,a,i,e),this.enableBody=!0,this.pointValue=s,this.itemType=e,t.physics.enable(this,Phaser.Physics.ARCADE),this.body.allowGravity=!1,this.alive=!0,t.add.existing(this);var h=this;this.events.onKilled.add(function(){n.x=h.x+h.width/2,n.y=h.y+h.height/2,n.gravity=0,n.start(!0,r,null,o)})},StackExchange.Unikong.TreasureItem.prototype=Object.create(Phaser.Sprite.prototype),StackExchange.Unikong.TreasureItem.prototype.constructor=StackExchange.Unikong.TreasureItem,StackExchange.Unikong.Rainbow=function(t,e,a,i,s){Phaser.Sprite.call(this,t,0,0,"rainbow"),this.frame=1,this.enableBody=!0,this.speed=400,this.sound=e,t.physics.enable(this,Phaser.Physics.ARCADE),this.checkWorldBounds=!0,this.outOfBoundsKill=!0,this.exists=!1,this.body.allowGravity=!1;var n=this;this.events.onKilled.add(function(){a.x=n.x+n.width/2,a.y=n.y+n.height/2,a.gravity=0,a.start(!0,i,null,s)})},StackExchange.Unikong.Rainbow.prototype=Object.create(Phaser.Sprite.prototype),StackExchange.Unikong.Rainbow.prototype.constructor=StackExchange.Unikong.Rainbow,StackExchange.Unikong.Rainbow.prototype.fire=function(t){if(t.isArmed){this.frame=t.isFacingLeft?0:1;var e=t.isFacingLeft?t.x+t.width:t.x+t.width/2-5,a=t.y;this.reset(e,a),this.body.velocity.x=t.isFacingLeft?-this.speed:this.speed,this.sound.play()}},StackExchange.Unikong.Boot=function(){},StackExchange.Unikong.Preload=function(){},StackExchange.Unikong.Preload.prototype={"preload":function(){var t=this.add.sprite(this.game.world.centerX,this.game.world.centerY,"progress");t.anchor.setTo(.5),this.load.setPreloadSprite(t),this.load.image("menu-bg","assets/welcome-bg.png"),this.load.spritesheet("btn-new","assets/btn-new.png",380,60),this.load.spritesheet("btn-exit","assets/btn-exit.png",380,60),this.load.spritesheet("btn-credits","assets/btn-credits.png",380,60),this.load.spritesheet("btn-leaderboard","assets/btn-leaderboard.png",380,60),this.load.spritesheet("btn-resume","assets/btn-resume.png",380,60),this.load.spritesheet("btn-restart","assets/btn-restart.png",380,60),this.load.spritesheet("btn-return","assets/btn-return.png",380,60),this.load.spritesheet("btn-continue","assets/btn-continue.png",380,60),this.load.spritesheet("player","assets/player.png",40,68),this.load.spritesheet("player-armed","assets/player-armed.png",42,68),this.load.spritesheet("boss","assets/unicorn.png",86,84),this.load.image("bg","assets/bg.png"),this.load.image("win-bg","assets/win-bg.png"),this.load.image("game-over-bg","assets/game-over-bg.png"),this.load.image("scores-bg","assets/scores-bg.png"),this.load.image("credits","assets/credits.png?v=1337"),this.load.image("platform","assets/steel.png"),this.load.image("ground","assets/brick.png"),this.load.image("diamond","assets/gem.png"),this.load.image("diamondParticle","assets/gem-particle.png"),this.load.image("ladder","assets/ladder.png"),this.load.image("sound-on","assets/sound-on.png"),this.load.image("sound-off","assets/sound-off.png"),this.load.spritesheet("downvote","assets/downvote-torch.png",34,77),this.load.image("bigGold","assets/gold-big.png"),this.load.image("bigSilver","assets/silver-big.png"),this.load.image("bigBronze","assets/bronze-big.png"),this.load.image("gold","assets/gold.png"),this.load.image("silver","assets/silver.png"),this.load.image("bronze","assets/bronze.png"),this.load.image("goldParticle","assets/gold-particle.png"),this.load.image("silverParticle","assets/silver-particle.png"),this.load.image("bronzeParticle","assets/bronze-particle.png"),this.load.image("heart","assets/heart.png"),this.load.spritesheet("rainbow","assets/rainbow.png",49,20),this.load.image("laser","assets/laser.png"),this.load.spritesheet("troll","assets/troll.png",48,54),this.load.image("chest-open","assets/chest-open.png"),this.load.image("chest-closed","assets/chest-closed.png"),this.load.image("key","assets/key.png"),this.load.audio("jump","assets/jump.mp3"),this.load.audio("death","assets/death.mp3"),this.load.audio("pickup","assets/pickup.mp3"),this.load.audio("pickup-badge","assets/pickup-badge.mp3"),this.load.audio("shoot","assets/shoot.mp3"),this.load.audio("theme","assets/music.mp3"),this.load.audio("gameOverIntro","assets/game-over-intro.mp3"),this.load.audio("gameOverTheme","assets/game-over-music.mp3"),this.load.audio("winTheme","assets/win.mp3"),this.load.audio("lossTheme","assets/lose.mp3")},"create":function(){this.state.start("Menu")}},StackExchange.Unikong.Boot.prototype={"preload":function(){this.load.image("progress","assets/load-progress.png")},"create":function(){this.state.start("Preload"),StackExchange.Unikong.game.input.keyboard.onDownCallback=function(t){StackExchange.Unikong.checkKonamiKey(t)}}},StackExchange.Unikong.Game=function(){};var pauseMenu,isPauseMenuButtonActivated;StackExchange.Unikong.Game.prototype={"createStairsL1":function(){this.stairs=this.game.add.group(),this.stairs.add(this.game.add.tileSprite(90,this.game.world.height-182-1,56,153,"ladder")),this.stairs.add(this.game.add.tileSprite(654,this.game.world.height-182-1,56,153,"ladder")),this.stairs.add(this.game.add.tileSprite(150,this.game.world.height-570-1,56,143,"ladder")),this.stairs.add(this.game.add.tileSprite(600,this.game.world.height-570-1,56,143,"ladder")),this.game.physics.enable(this.stairs,Phaser.Physics.ARCADE)},"createPlatformsL1":function(){this.platforms=this.game.add.group(),this.platforms.enableBody=!0;var t=this.game.add.tileSprite(0,this.game.world.height-30,gameWidth,platformSpriteHeight,"ground"),e=this.game.add.tileSprite(0,this.game.world.height-2*platformSpriteHeight-stairHeight-18,810,platformSpriteHeight,"platform"),a=this.game.world.height-3*platformSpriteHeight-2*stairHeight,i=this.game.add.tileSprite(0,a,3*platformSpriteWidth,platformSpriteHeight,"platform"),s=this.game.add.tileSprite(i.width+gapWidth,a,7*platformSpriteWidth,platformSpriteHeight,"platform"),n=this.game.add.tileSprite(this.game.world.width-3*platformSpriteWidth,a,3*platformSpriteWidth,platformSpriteHeight,"platform"),r=this.game.world.height-4*platformSpriteHeight-3*stairHeight,o=this.game.add.tileSprite(0,r,6*platformSpriteWidth,platformSpriteHeight,"platform"),h=this.game.add.tileSprite(this.game.world.width-6*platformSpriteWidth,r,6*platformSpriteWidth,platformSpriteHeight,"platform"),d=this.game.add.tileSprite(0,this.game.world.height-5*platformSpriteHeight-4*stairHeight-10,810,platformSpriteHeight,"platform");this.platforms.add(t),this.platforms.add(e),this.platforms.add(i),this.platforms.add(s),this.platforms.add(n),this.platforms.add(o),this.platforms.add(h),this.platforms.add(d),this.platforms.forEach(function(t){t.body.immovable=!0},this)},"createWinConditionL1":function(){this.diamonds=this.game.add.group();var t=this.game.add.emitter(0,0,100);t.makeParticles("diamondParticle"),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",395,48,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",737,355,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",47,355,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",395,270,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",395,555,100,t,750,25))},"createTreasureL1":function(){this.treasures=this.game.add.group();var t=this.game.add.emitter(0,0,100);t.makeParticles("bronzeParticle");for(var e=200;650>e;e+=50)this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"bronze",e,630,10,t,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"bronze",e,480,10,t,400,10));for(var e=250;600>e;e+=50)this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"bronze",e,365,10,t,400,10));var a=this.game.add.emitter(0,0,100);a.makeParticles("silverParticle"),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",18,365,25,a,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",85,365,25,a,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",708,365,25,a,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",775,365,25,a,400,10));var i=this.game.add.emitter(0,0,100);i.makeParticles("goldParticle"),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",18,235,50,i,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",85,235,50,i,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",708,235,50,i,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",775,235,50,i,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",345,280,50,i,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",455,280,50,i,400,10))},"createStairsL2":function(){this.stairs=this.game.add.group(),this.stairs.add(this.game.add.tileSprite(650,this.game.world.height-150-1,56,123,"ladder")),this.stairs.add(this.game.add.tileSprite(100,this.game.world.height-270-1,56,121,"ladder")),this.stairs.add(this.game.add.tileSprite(425,this.game.world.height-570-1,56,151,"ladder")),this.stairs.add(this.game.add.tileSprite(750,this.game.world.height-570-1,56,151,"ladder")),this.game.physics.enable(this.stairs,Phaser.Physics.ARCADE)},"createPlatformsL2":function(){this.platforms=this.game.add.group(),this.platforms.enableBody=!0;var t=this.game.add.tileSprite(0,this.game.world.height-30,gameWidth,platformSpriteHeight,"ground"),e=this.game.add.tileSprite(0,this.game.world.height-150,this.game.world.width,platformSpriteHeight,"platform"),a=this.game.add.tileSprite(0,this.game.world.height-270,this.game.world.width,platformSpriteHeight,"platform"),i=this.game.world.height-420,s=this.game.add.tileSprite(0,i,220,platformSpriteHeight,"platform"),n=this.game.add.tileSprite(s.width+65,i,220,platformSpriteHeight,"platform"),r=this.game.add.tileSprite(this.game.world.width-220,i,220,platformSpriteHeight,"platform"),o=this.game.add.tileSprite(0,this.game.world.height-5*platformSpriteHeight-4*stairHeight-10,810,platformSpriteHeight,"platform");this.platforms.add(t),this.platforms.add(e),this.platforms.add(a),this.platforms.add(s),this.platforms.add(n),this.platforms.add(r),this.platforms.add(o),this.platforms.forEach(function(t){t.body.immovable=!0},this)},"createWinConditionL2":function(){this.diamonds=this.game.add.group();var t=this.game.add.emitter(0,0,100);t.makeParticles("diamondParticle"),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",35,495,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",395,335,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",145,200,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",395,75,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",675,200,100,t,750,25))},"createTreasureL2":function(){this.treasures=this.game.add.group();var t=this.game.add.emitter(0,0,100);t.makeParticles("bronzeParticle");for(var e=200;650>e;e+=150)this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"bronze",e,630,10,t,400,10));var a=this.game.add.emitter(0,0,100);a.makeParticles("silverParticle");for(var e=175;625>e;e+=150)this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",e,510,25,a,400,10));for(var i=0,e=150;650>=e;e+=30)i%2==0?this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"bronze",e,400,10,t,400,10)):this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",e,400,25,a,400,10)),i++;this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",30,215,25,a,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",70,215,25,a,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",110,215,25,a,400,10));var s=this.game.add.emitter(0,0,100);s.makeParticles("goldParticle"),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",775,630,50,s,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",247,290,50,s,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",540,290,50,s,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",679,255,50,s,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",395,225,50,s,400,10))},"createLaserL2":function(){this.laser=this.game.add.sprite(750,510,"laser"),this.laser.enableBody=!0,this.game.physics.enable(this.laser,Phaser.Physics.ARCADE),this.laser.body.allowGravity=!1,this.ammo=this.game.add.group();var t=this.game.add.emitter(0,0,100);t.makeParticles("goldParticle");for(var e=0;50>e;e++){var a=new StackExchange.Unikong.Rainbow(this.game,this.shootSound,t,200,25);this.ammo.add(a)}this.game.physics.enable(this.ammo,Phaser.Physics.ARCADE)},"createEnemiesL2":function(){this.trolls=this.game.add.group(),this.trolls.add(new StackExchange.Unikong.Troll(this.game,10,495,this.player)),this.trolls.add(new StackExchange.Unikong.Troll(this.game,10,375,this.player)),this.trolls.add(new StackExchange.Unikong.Troll(this.game,700,375,this.player))},"createStairsL3":function(){this.stairs=this.game.add.group(),this.stairs.add(this.game.add.tileSprite(385,this.game.world.height-200-1,56,171,"ladder")),this.stairs.add(this.game.add.tileSprite(100,this.game.world.height-570-1,56,246,"ladder")),this.stairs.add(this.game.add.tileSprite(654,this.game.world.height-570-1,56,246,"ladder")),this.game.physics.enable(this.stairs,Phaser.Physics.ARCADE)},"createPlatformsL3":function(){this.platforms=this.game.add.group(),this.platforms.enableBody=!0;var t=this.game.add.tileSprite(0,this.game.world.height-30,gameWidth,platformSpriteHeight,"ground"),e=this.game.add.tileSprite(320,this.game.world.height-200,190,platformSpriteHeight,"platform"),a=this.game.add.tileSprite(0,this.game.world.height-325,275,platformSpriteHeight,"platform"),i=this.game.add.tileSprite(this.game.world.width-275,this.game.world.height-325,275,platformSpriteHeight,"platform"),s=this.game.add.tileSprite(320,this.game.world.height-450,190,platformSpriteHeight,"platform"),n=this.game.add.tileSprite(0,this.game.world.height-5*platformSpriteHeight-4*stairHeight-10,810,platformSpriteHeight,"platform");this.platforms.add(t),this.platforms.add(e),this.platforms.add(a),this.platforms.add(i),this.platforms.add(s),this.platforms.add(n),this.platforms.forEach(function(t){t.body.immovable=!0},this)},"createWinConditionL3":function(){this.diamonds=this.game.add.group();var t=this.game.add.emitter(0,0,100);t.makeParticles("diamondParticle"),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",35,335,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",345,215,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",465,215,100,t,750,25)),this.diamonds.add(new StackExchange.Unikong.TreasureItem(this.game,"diamond",755,335,100,t,750,25)),this.chest=this.game.add.sprite(395,75,"chest-closed"),this.game.physics.enable(this.chest,Phaser.Physics.ARCADE),this.chest.enableBody=!0,this.chest.body.immovable=!0},"createTreasureL3":function(){this.treasures=this.game.add.group();var t=this.game.add.emitter(0,0,100);t.makeParticles("bronzeParticle");for(var e=100;350>e;e+=50)this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"bronze",e,630,10,t,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"bronze",e+415,630,10,t,400,10));var a=this.game.add.emitter(0,0,100);a.makeParticles("silverParticle");for(var e=50;350>e;e+=50)this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",e,510,25,a,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"silver",e+465,510,25,a,400,10));
var i=this.game.add.emitter(0,0,100);i.makeParticles("goldParticle"),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",350,630,50,i,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",465,630,50,i,400,10)),this.treasures.add(new StackExchange.Unikong.TreasureItem(this.game,"gold",405,225,50,i,400,10))},"createLaserL3":function(){this.laser=this.game.add.sprite(397,440,"laser"),this.laser.enableBody=!0,this.game.physics.enable(this.laser,Phaser.Physics.ARCADE),this.laser.body.allowGravity=!1,this.ammo=this.game.add.group();var t=this.game.add.emitter(0,0,100);t.makeParticles("goldParticle");for(var e=0;50>e;e++){var a=new StackExchange.Unikong.Rainbow(this.game,this.shootSound,t,200,25);this.ammo.add(a)}this.game.physics.enable(this.ammo,Phaser.Physics.ARCADE)},"createEnemiesL3":function(){this.trolls=this.game.add.group(),this.trolls.add(new StackExchange.Unikong.Troll(this.game,55,320,this.player,45,275)),this.trolls.add(new StackExchange.Unikong.Troll(this.game,655,320,this.player,this.game.world.width-275,755)),this.trolls.add(new StackExchange.Unikong.Troll(this.game,320,195,this.player,320,510)),this.trolls.add(new StackExchange.Unikong.Troll(this.game,480,195,this.player,320,510))},"createSounds":function(){this.jumpSound=this.game.add.audio("jump",.15,!1),this.deathSound=this.game.add.audio("death",.3,!1),this.pickupSound=this.game.add.audio("pickup",.3,!1),this.pickupBadgeSound=this.game.add.audio("pickup-badge",.3,!1),this.shootSound=this.game.add.audio("shoot",.3,!1),this.winSound=this.game.add.audio("winTheme",.3,!1),this.lossSound=this.game.add.audio("lossTheme",.3,!1)},"attack":function(){this.player.isArmed&&this.ammo.getFirstExists(!1).fire(this.player)},"wireUpControls":function(){this.cursors=this.game.input.keyboard.createCursorKeys();var t=this.game.input.keyboard.addKey(Phaser.Keyboard.P);t.onDown.add(this.showPauseMenu,this);var e=this.game.input.keyboard.addKey(Phaser.Keyboard.ESC);e.onDown.add(this.showPauseMenu,this);var a=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);a.onDown.add(this.attack,this)},"showPauseMenu":function(){if(!this.game.paused){if(isPauseMenuButtonActivated=!1,this.game.paused=!0,this.pauseOverlay)return this.pauseOverlay.alpha=1,this.pauseOverlay.visible=!0,void 0;btnArray=[],btnArrayIndex=0,this.pauseOverlay=this.game.add.group();var t=this.game.add.sprite(0,0,"menu-bg");t.alpha=.95;var e=this.game.add.sprite(65,215,"btn-resume");e.frame=1,this.game.physics.enable(e,Phaser.Physics.ARCADE),e.body.allowGravity=!1;var a=this.game.add.sprite(65,285,"btn-restart");a.frame=0,this.game.physics.enable(a,Phaser.Physics.ARCADE),a.body.allowGravity=!1;var i=this.game.add.sprite(65,355,"btn-return");i.frame=0,this.game.physics.enable(i,Phaser.Physics.ARCADE),i.body.allowGravity=!1;var s=this.game.add.sprite(65,425,"btn-exit");s.frame=0,this.game.physics.enable(s,Phaser.Physics.ARCADE),s.body.allowGravity=!1,this.pauseOverlay.add(t),this.pauseOverlay.add(e),this.pauseOverlay.add(a),this.pauseOverlay.add(i),this.pauseOverlay.add(s),btnArray.push(e),btnArray.push(a),btnArray.push(i),btnArray.push(s);var n=this.game.input.keyboard.addKey(Phaser.Keyboard.UP),r=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN);n.onDown.add(this.toggleMenu,this),r.onDown.add(this.toggleMenu,this);var o=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);o.onDown.add(this.letsGo,this);var h=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);h.onDown.add(this.letsGo,this),this.game.input.onDown.add(function(t){function n(t,e){return t.x>=e.x&&t.x<=e.x+e.body.width&&t.y>=e.y&&t.y<=e.y+e.body.height}this.game.paused&&(n(t,e)?(this.toggleMenu(null,0),this.letsGo()):n(t,a)?(this.toggleMenu(null,1),this.letsGo()):n(t,i)?(this.toggleMenu(null,2),this.letsGo()):n(t,s)&&(this.toggleMenu(null,3),this.letsGo()))},this)}},"toggleMenu":function(t,e){if(!isPauseMenuButtonActivated&&this.game.paused){if(void 0!==e)return btnArray.forEach(function(t){t.frame=0}),btnArray[e].frame=1,btnArrayIndex=e,void 0;var a=t.keyCode===Phaser.KeyCode.UP;btnArray[btnArrayIndex].frame=0,btnArrayIndex=((a?--btnArrayIndex:++btnArrayIndex)%btnArray.length+btnArray.length)%btnArray.length,btnArray[btnArrayIndex].frame=1}},"letsGo":function(){if(this.game.paused){isPauseMenuButtonActivated=!0,this.game.paused=!1;var t=this.game.add.tween(this.pauseOverlay).to({"alpha":0},200);t.onComplete.add(function(){this.pauseOverlay.visible=!1,1===btnArray[0].frame||(1===btnArray[1].frame?(this.destroyPauseOverlay(),this.game.state.start("Restart")):1===btnArray[2].frame?(this.destroyPauseOverlay(),this.game.state.start("Menu")):StackExchange.Unikong.quit())},this),t.start()}},"createTopbar":function(){this.scoreText=this.game.add.text(450,20,"rep "+score,fontStyle),this.goldText=this.game.add.text(605,20,goldCount,fontStyle),this.silverText=this.game.add.text(680,20,silverCount,fontStyle),this.bronzeText=this.game.add.text(755,20,bronzeCount,fontStyle),this.game.add.sprite(575,15,"bigGold"),this.game.add.sprite(650,15,"bigSilver"),this.game.add.sprite(725,15,"bigBronze"),this.game.add.sprite(45,15,"heart"),this.livesText=this.game.add.text(80,20,remainingLives,fontStyle)},"create":function(){this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.add.sprite(0,0,"bg"),this.createSounds(),StackExchange.Unikong.startMusic(),StackExchange.Unikong.bindSoundToggle(),this.createTopbar();var t=StackExchange.Unikong.effectiveLevel();1===t?(this.createPlatformsL1(),this.createStairsL1(),this.createWinConditionL1(),this.createTreasureL1()):2===t?(this.createPlatformsL2(),this.createStairsL2(),this.createTreasureL2(),this.createLaserL2(),this.createWinConditionL2()):(this.createPlatformsL3(),this.createStairsL3(),this.createTreasureL3(),this.createLaserL3(),this.createWinConditionL3()),this.wireUpControls(),this.player=new StackExchange.Unikong.Player(this.game,32,this.game.world.height-100,"player",this.lossSound),this.boss=new StackExchange.Unikong.Boss(this.game,32,45,this.player),2===t?this.createEnemiesL2():3===t&&this.createEnemiesL3(),this.game.input.keyboard.addKeyCapture([Phaser.KeyCode.UP,Phaser.KeyCode.DOWN,Phaser.KeyCode.LEFT,Phaser.KeyCode.RIGHT,Phaser.Keyboard.B,Phaser.Keyboard.A,Phaser.Keyboard.S,Phaser.Keyboard.P,Phaser.KeyCode.ENTER,Phaser.KeyCode.ESC,Phaser.KeyCode.SPACEBAR])},"climbStairs":function(t,e){var a=t.body.y+t.body.height,i=e.body.y+e.body.height;return a==i&&this.cursors.down.isDown?(t.body.velocity.y=0,void 0):(this.cursors.up.isDown||this.cursors.down.isDown?(t.body.allowGravity=!1,t.body.velocity.y=this.cursors.up.isDown?-climbSpeed:climbSpeed,t.isClimbing=!0,t.animations.paused?t.animations.paused=!1:t.animations.play("climb")):(t.body.velocity.y=0,t.isClimbing&&(t.animations.paused=!0)),void 0)},"climbStairsResetCheck":function(){var t=this.player;if(t.isClimbing){var e=!1;this.stairs.forEach(function(a){var i=t.body.y+t.body.height,s=(t.body.y,a.body.y+a.body.height),n=a.body.y;t.overlap(a)&&s>=i&&i>=n+1&&(e=!0)}),e||(t.isClimbing=!1,t.body.velocity.y=0,t.body.allowGravity=!0,t.animations.paused=!1)}},"updateScore":function(t){score+=t,this.scoreText.text="rep "+score},"destroyPauseOverlay":function(){this.pauseOverlay&&(this.pauseOverlay.destroy(),this.pauseOverlay=null)},"winGame":function(t,e){if(e.kill(),this.pickupSound.play(),this.updateScore(100),0===this.diamonds.countLiving()){var a=StackExchange.Unikong.effectiveLevel();1===a||2===a?(StackExchange.Unikong.level+=1,this.destroyPauseOverlay(),this.game.world.removeAll(),this.game.state.start("LevelTransition")):(this.key=this.game.add.sprite(395,215,"key"),this.game.physics.enable(this.key,Phaser.Physics.ARCADE),this.keyParticleEmitter=this.game.add.emitter(0,0,100),this.keyParticleEmitter.makeParticles("goldParticle"),this.keyParticleEmitter.x=this.key.x+this.key.body.width/2,this.keyParticleEmitter.y=this.key.y+this.key.body.height/2,this.keyParticleEmitter.gravity=0,this.keyParticleEmitter.start(!1,200,75))}},"winWholeGame":function(){this.boss.stopDownvotes(),this.boss.stopped=!0;var t=StackExchange.Unikong.level/3;this.updateScore(500*t);var e=this.game.add.text(this.game.world.centerX,-10,Math.random()<=.5?"good job":"nicely done",fontStyle);e.anchor.setTo(.5,.5),this.destroyPauseOverlay(),this.winSound.play();var a=this.game.add.tween(e).to({"y":this.game.world.centerY},3e3,"Quart.easeOut");a.onComplete.add(function(){this.game.state.start("Win")},this);var i=this.game.add.emitter(this.game.world.centerX,0,200);i.makeParticles("diamond"),i.width=this.game.world.width,i.setXSpeed(-5,5),i.setYSpeed(50,500),i.minParticleScale=.1,i.maxParticleScale=1,i.minRotation=0,i.maxRotation=360,i.start(!1,1600,5,0),a.start()},"loseGame":function(t,e){t.isDead||(this.deathSound.play(),e!==this.boss&&e.kill(),this.boss.stopDownvotes(),remainingLives--,this.game.add.tween(this.livesText).to({"alpha":0},500,Phaser.Easing.Linear.Out,!0).onComplete.add(function(){this.livesText.text=remainingLives.toString(),this.game.add.tween(this.livesText).to({"alpha":1},500,Phaser.Easing.Linear.In,!0)},this),t.animations.play("dead"),t.wompwomp())},"yiss":function(t,e){this.pickupBadgeSound.play(),this.updateScore(e.pointValue),"bronze"===e.itemType&&(bronzeCount++,this.bronzeText.text=bronzeCount),"silver"===e.itemType&&(silverCount++,this.silverText.text=silverCount),"gold"===e.itemType&&(goldCount++,this.goldText.text=goldCount),e.kill()},"clean":function(){console.log("woof")},"update":function(){this.player.body.velocity.x=0,this.boss.move();var t=StackExchange.Unikong.effectiveLevel();return t>1&&this.trolls.forEach(function(t){t.move()}),this.player.isDead?(this.player.animations.stop(),this.player.frame=4,void 0):(this.game.physics.arcade.collide(this.player,this.platforms,null,function(t){return!t.isClimbing&&!t.isDead},this),this.game.physics.arcade.overlap(this.player,this.stairs,this.climbStairs,null,this),this.climbStairsResetCheck(),t>1&&(this.game.physics.arcade.collide(this.player,this.laser,function(t,e){t.arm(),e.destroy()},null,this),this.game.physics.arcade.collide(this.player,this.trolls,this.loseGame,null,this),this.game.physics.arcade.collide(this.trolls,this.ammo,function(t,e){this.deathSound.play(),t.wompwomp(),e.kill(),this.updateScore(150)},null,this),this.game.physics.arcade.collide(this.platforms,this.ammo,function(t,e){e.kill()},null,this),this.game.physics.arcade.collide(this.boss,this.ammo,function(t,e){e.kill()},null,this)),this.game.physics.arcade.overlap(this.player,this.treasures,this.yiss,null,this),3===StackExchange.Unikong.effectiveLevel()&&(this.key&&this.game.physics.arcade.collide(this.player,this.key,function(t,e){t.hasKey=!0,this.updateScore(100),this.keyParticleEmitter.destroy(),e.kill(),this.pickupSound.play()},null,this),this.game.physics.arcade.collide(this.player,this.chest,function(t,e){this.boss.stopped||(e.loadTexture("chest-open"),this.winWholeGame())},function(t){return t.hasKey},this)),this.game.physics.arcade.collide(this.player,this.diamonds,this.winGame,null,this),this.game.physics.arcade.collide(this.player,this.boss.downvotes,this.loseGame,null,this),this.game.physics.arcade.collide(this.player,this.boss,this.loseGame,null,this),this.game.physics.arcade.collide(this.player,this.troll,this.loseGame,null,this),this.cursors.left.isDown?(this.player.body.velocity.x=-moveSpeed,this.player.lastHorizontalMoveLeft=!0,this.player.isFacingLeft||(this.player.scale.x*=-1,this.player.isFacingLeft=!0),this.player.animations.play("right"),this.player.isClimbing||(this.player.body.allowGravity=!0)):this.cursors.right.isDown?(this.player.body.velocity.x=moveSpeed,this.player.lastHorizontalMoveLeft=!1,this.player.isFacingLeft&&(this.player.scale.x*=-1,this.player.isFacingLeft=!1),this.player.animations.play("right"),this.player.isClimbing||(this.player.body.allowGravity=!0)):this.player.isClimbing||(this.player.animations.stop(),this.player.frame=4),this.cursors.up.isDown&&this.player.body.touching.down&&!this.player.isClimbing&&(this.jumpSound.play(),this.player.body.allowGravity=!0,this.player.body.velocity.y=-jumpSpeed),void 0)}},StackExchange.Unikong.RestartGame=function(){},StackExchange.Unikong.RestartGame.prototype={"create":function(){score=0,StackExchange.Unikong.level=1,gameSpeedFactor=1,weaponDropRateFactor=1,remainingLives=3,bronzeCount=0,silverCount=0,goldCount=0,this.game.state.start("LevelTransition")}},StackExchange.Unikong.LevelTransition=function(){},StackExchange.Unikong.LevelTransition.prototype={"create":function(){var t=this.game.add.group(),e=this.game.add.sprite(0,0,"bg"),a=this.game.add.text(this.game.world.centerX,this.game.world.centerY,"level "+StackExchange.Unikong.level,fontStyle);a.anchor.setTo(.5),t.add(e),t.add(a);var i=this.game.add.tween(t).to({"alpha":0},2500);i.onComplete.add(function(){this.game.state.start("Game")},this),i.start()}},StackExchange.Unikong.game=new Phaser.Game(810,700,Phaser.CANVAS,"target"),StackExchange.Unikong.bgMusic={},StackExchange.Unikong.level=1,StackExchange.Unikong.effectiveLevel=function(){var t=StackExchange.Unikong.level%3;return 0==t?3:t};var isLocalStorageSupported="undefined"!=typeof Storage;StackExchange.Unikong.quit=function(){StackExchange.Unikong.game.destroy()},StackExchange.Unikong.startMusic=function(){StackExchange.Unikong.bgMusic&&StackExchange.Unikong.bgMusic.isPlaying||(isKonamiActive||(StackExchange.Unikong.bgMusic=this.game.add.audio("theme",.5,!0)),StackExchange.Unikong.bgMusic.play())},StackExchange.Unikong.stopMusic=function(){var t=StackExchange.Unikong.bgMusic;t&&t.isPlaying&&t.stop()},StackExchange.Unikong.bindSoundToggle=function(){var t=StackExchange.Unikong.game.input.keyboard.addKey(Phaser.Keyboard.S);if(t.onDown.add(function(){StackExchange.Unikong.toggleSound()}),isLocalStorageSupported){var e=localStorage.getItem("stackoverflow-unikong-mute");null!==e&&(StackExchange.Unikong.game.sound.mute=JSON.parse(e)===!0)}else StackExchange.Unikong.game.sound.mute=!1;soundImg=StackExchange.Unikong.game.add.image(10,15,StackExchange.Unikong.game.sound.mute?"sound-off":"sound-on"),soundImg.inputEnabled=!0,soundImg.events.onInputDown.add(function(){this.toggleSound()},this)},StackExchange.Unikong.toggleSound=function(){StackExchange.Unikong.game.sound.mute=!StackExchange.Unikong.game.sound.mute,soundImg.loadTexture(StackExchange.Unikong.game.sound.mute?"sound-off":"sound-on"),isLocalStorageSupported&&localStorage.setItem("stackoverflow-unikong-mute",JSON.stringify(StackExchange.Unikong.game.sound.mute))},StackExchange.Unikong.generateLeaderboardScores=function(t,e){var a=4e4,i=4e3,s=10,n=["RAR","GBE","KBR","GBR","JBU","MCE","JCH","BCO","OCO","NCR","GDA","JDI","BDU","YEL","AGA","AGO","MGR","DHA","JHA","MHE","BHO","MHO","NLA","ALE","TLI","ALI","SMA","AMA","MMC","KMO","BNI","XNI","CPE","SPR","JPU","KRA","DRO","BRO","JSH","MSH","KTH","STR","DWA","AWA","REX"],r=[];if(isLocalStorageSupported){var o=localStorage.getItem("stackoverflow-unikong-leader-board");null!==o&&(r=JSON.parse(o))}var h=0;if(0===r.length){h=score.toString().length;for(var d=0;s>d;d++){var g=n[Math.floor(Math.random()*n.length)];0==d?g="JON":n.splice(n.indexOf(g),1);var l=a-d*i;r.push({"initials":g,"score":l}),h=Math.max(h,l.toString().length)}}else for(var d=0;d<r.length;d++)h=Math.max(h,r[d].score.toString().length);if(e&&r.push({"initials":"YOU","score":score}),r.sort(function(t,e){return t.score<e.score?1:t.score>e.score?-1:0}),t)for(var d=0;s>d;d++){for(var c=r[d],m="YOU"===c.initials?"#F48024":"#FFFFFF",p=c.score.toString();p.length<h;)p=" "+p;var u=this.game.add.text(this.game.world.centerX,this.game.world.centerY-115+25*d,c.initials+"    "+p,$.extend(fontStyle,{"fill":m}));u.anchor.setTo(.5),t.add(u)}if(isLocalStorageSupported)var o=localStorage.setItem("stackoverflow-unikong-leader-board",JSON.stringify(r))};var stairHeight=100,platformSpriteWidth=48,platformSpriteHeight=32,stairWidth=56,gameWidth=810,gapWidth=90,climbSpeed=150,moveSpeed=150,jumpSpeed=300,score=0,goldCount=0,silverCount=0,bronzeCount=0,gameSpeedFactor=1,weaponDropRateFactor=1,trollSpeed=25,unicornTargetingRate=35,remainingLives=3,fontStyle={"font":"Courier","fontSize":"20px","fill":"#fff"};StackExchange.Unikong.game.state.add("Boot",StackExchange.Unikong.Boot),StackExchange.Unikong.game.state.add("Preload",StackExchange.Unikong.Preload),StackExchange.Unikong.game.state.add("Menu",StackExchange.Unikong.Menu),StackExchange.Unikong.game.state.add("Game",StackExchange.Unikong.Game),StackExchange.Unikong.game.state.add("Win",StackExchange.Unikong.Win),StackExchange.Unikong.game.state.add("Loss",StackExchange.Unikong.Loss),StackExchange.Unikong.game.state.add("Restart",StackExchange.Unikong.RestartGame),StackExchange.Unikong.game.state.add("Leaderboard",StackExchange.Unikong.Leaderboard),StackExchange.Unikong.game.state.add("Credits",StackExchange.Unikong.Credits),StackExchange.Unikong.game.state.add("LevelTransition",StackExchange.Unikong.LevelTransition),StackExchange.Unikong.game.state.start("Boot");var konamiArray=[Phaser.Keyboard.UP,Phaser.Keyboard.UP,Phaser.Keyboard.DOWN,Phaser.Keyboard.DOWN,Phaser.Keyboard.LEFT,Phaser.Keyboard.RIGHT,Phaser.Keyboard.LEFT,Phaser.Keyboard.RIGHT,Phaser.Keyboard.B,Phaser.Keyboard.A,Phaser.Keyboard.ENTER],konamiArrayPointer=0,isKonamiActive=!1;StackExchange.Unikong.checkKonamiKey=function(t){if(konamiArrayPointer<konamiArray.length&&konamiArray[konamiArrayPointer]===t.keyCode?konamiArrayPointer++:konamiArrayPointer=0,konamiArrayPointer===konamiArray.length)if(konamiArrayPointer=0,StackExchange.Unikong.stopMusic(),isKonamiActive)isKonamiActive=!1,StackExchange.Unikong.startMusic();else{isKonamiActive=!0;var e=this.game.add.emitter(this.game.world.centerX,0,400);e.makeParticles("goldParticle"),e.width=this.game.world.width,e.setXSpeed(-5,5),e.setYSpeed(300,500),e.minParticleScale=.5,e.maxParticleScale=1,e.minRotation=0,e.maxRotation=0,e.start(!1,1600,5,0);var a=this.game.add.tween(e).to({"alpha":0},6e3);a.onComplete.add(function(){e.destroy()},this),a.start();var i=StackExchange.Unikong.game.add.audio("gameOverIntro",.3,!1);i.onStop.add(function(){StackExchange.Unikong.bgMusic=StackExchange.Unikong.game.add.audio("gameOverTheme",.3,!0),StackExchange.Unikong.bgMusic.play()}),i.play()}};